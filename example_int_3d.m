%EXAMPLE_INT_3D Evaluation of refinable integral of two 3-D functions.
% Evaluates a refinable integral with two factors of refinable 3-D functions
% in the integral:
%
%   I(z) = \int f_0(x) * f_1(x - z_1) \dx,
%
% where `f_0, f_1` are box splines and `z_1` is a 3-dimensional integer vector.
%
% See also: EXAMPLE_INT_1D, EXAMPLE_INT_2D, REFINE.
%
% ----------------------------------------------------------------------------
% Author:    Johann Rudi <johann@ices.utexas.edu>
% ----------------------------------------------------------------------------

%% Set MATLAB Environment

% clearing
clear

% initialize refine
refine_init


%% Set Parameters

% set mask coefficients
a_0 = zeros(5, 5, 5);
a_0(1,:,:) = [
    0.0625  0.0625  0.0     0.0     0.0    ; ...
    0.0625  0.125   0.0625  0.0     0.0    ; ...
    0.0     0.0625  0.0625  0.0     0.0    ; ...
    0.0     0.0     0.0     0.0     0.0    ; ...
    0.0     0.0     0.0     0.0     0.0    ...
];
a_0(2,:,:) = [
    0.0625  0.125   0.0625  0.0     0.0    ; ...
    0.125   0.3125  0.25    0.0625  0.0    ; ...
    0.0625  0.25    0.3125  0.125   0.0    ; ...
    0.0     0.0625  0.125   0.0625  0.0    ; ...
    0.0     0.0     0.0     0.0     0.0    ...
];
a_0(3,:,:) = [
    0.0     0.0625  0.0625  0.0     0.0    ; ...
    0.0625  0.25    0.3125  0.125   0.0    ; ...
    0.0625  0.3125  0.5     0.3125  0.0625 ; ...
    0.0     0.125   0.3125  0.25    0.0625 ; ...
    0.0     0.0     0.0625  0.0625  0.0    ...
];
a_0(4,:,:) = [
    0.0     0.0     0.0     0.0     0.0    ; ...
    0.0     0.0625  0.125   0.0625  0.0    ; ...
    0.0     0.125   0.3125  0.25    0.0625 ; ...
    0.0     0.0625  0.25    0.3125  0.125  ; ...
    0.0     0.0     0.0625  0.125   0.0625 ...
];
a_0(5,:,:) = [
    0.0     0.0     0.0     0.0     0.0    ; ...
    0.0     0.0     0.0     0.0     0.0    ; ...
    0.0     0.0     0.0625  0.0625  0.0    ; ...
    0.0     0.0     0.0625  0.125   0.0625 ; ...
    0.0     0.0     0.0     0.0625  0.0625 ...
];
a_1 = a_0;

% combine the mask coefficients into a cell-array
mask = {a_0, a_1};


%% Compute Integral Evaluation

% evaluate refinable integral
[x,y] = refine(mask, 0, 0, 'Display','on');

